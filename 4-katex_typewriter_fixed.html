<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- KaTeX CSS + JS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>

<!-- Motion One UMD -->
<script src="https://cdn.jsdelivr.net/npm/@motionone/dom/dist/motion.umd.min.js"></script>

<style>
  body{
    background:#0b1220;
    color:white;
    font-family:system-ui;
    margin:0;
    padding:20px;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
  }

  #formula{
    font-size:clamp(22px,7vw,42px);
  }

  .symbol{
    display:inline-block;
    opacity:0;
    transform:translateY(8px);
  }

  button{
    margin-top:20px;
    padding:10px 16px;
    font-size:18px;
    border:0;
    border-radius:8px;
    cursor:pointer;
    background:#58a6ff;
    color:#001;
    font-weight:bold;
  }
</style>
</head>
<body>

<div>
  <div id="formula"></div>
  <button id="play">Reproduzir</button>
</div>

<script>
(function(){

  // EXPRESSÃO LATEX – totalmente funcional
  const expr = "\\displaystyle \\int_{0}^{1} x^{2}\\,dx = \\tfrac{1}{3}";

  // Renderiza KaTeX corretamente
  const container = document.getElementById("formula");
  katex.render(expr, container, { throwOnError:false });

  // Seleciona todos os nós de texto da fórmula
  function getSymbols(){
    const nodes = container.querySelectorAll("span");
    const list = [];
    nodes.forEach(n => {
      const t = n.textContent.trim();
      if (t.length === 1) list.push(n);
    });
    return list;
  }

  const symbols = getSymbols();

  // Coloca cada símbolo dentro de um span animável
  symbols.forEach(s => {
    if(!s.classList.contains("symbol")){
      const w = document.createElement("span");
      w.className = "symbol";
      s.parentNode.insertBefore(w, s);
      w.appendChild(s);
    }
  });

  const animated = Array.from(container.querySelectorAll(".symbol"));

  // Animação — efeito digitação gradual
  function play(){
    animated.forEach(el => {
      el.style.opacity = "0";
      el.style.transform = "translateY(8px)";
    });

    animated.forEach((el, i) => {
      motion.animate(el,
        { opacity:[0,1], transform:["translateY(8px)","translateY(0px)"] },
        { duration:0.25, delay:i * 0.07, easing:"cubic-bezier(.22,1,.36,1)" }
      );
    });
  }

  document.getElementById("play").onclick = play;

  // autoplay inicial
  setTimeout(play, 300);

})();
</script>

</body>
</html>
